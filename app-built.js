define("graphit/global",["require"],function(e){var t="graphit";return t in window?(console.log(">>> Global namespace already defined"),window[t]):(console.log(">>> Creating global namespace"),window[t]={__MODULE__:"graphit",__VERSION__:"0.0.1",tool:null,util:null,shape:null},console.log("> graphit",window[t]),window[t])}),define("graphit/exception/MissingParameter",["require"],function(e){function t(e){this.name="MissingParameterException",this.message=e}return t.prototype=new Error,t.prototype.constructor=t,t}),define("graphit/exception/InvalidDocumentId",["require"],function(e){function t(e){this.name="InvalidDocumentId",this.message=e}return t.prototype=new Error,t.prototype.constructor=t,t}),define("graphit/draw/Context",["require","graphit/exception/InvalidDocumentId"],function(e){function n(e){this.__MODULE__="graphit/draw/Context";if(!(this instanceof n))return new n(e);n.prototype.arc||n.setup.call(this,this.ctx),this.setCanvas(e)}var t=e("graphit/exception/InvalidDocumentId");return n.prototype.setCanvas=function(e){this.ctx=e.getContext("2d")},n.prototype.getCtx=function(){return this.ctx},n.prototype.copyData=function(e,t,n,r,i){this.ctx.putImageData(e.ctx.getImageData(t,n,r,i),0,0)},n.setup=function(){var e=["arc","arcTo","beginPath","bezierCurveTo","clearRect","clip","closePath","drawImage","fill","fillRect","fillText","lineTo","moveTo","quadraticCurveTo","rect","restore","rotate","save","scale","setTransform","stroke","strokeRect","strokeText","transform","translate"],t=["createPattern","drawFocusRing","isPointInPath","measureText","createImageData","createLinearGradient","createRadialGradient","getImageData","putImageData"],r=["canvas","fillStyle","font","globalAlpha","globalCompositeOperation","lineCap","lineJoin","lineWidth","miterLimit","shadowOffsetX","shadowOffsetY","shadowBlur","shadowColor","strokeStyle","textAlign","textBaseline"],i,s;for(var o=0,u=e.length;o<u;o++){var a=e[o];n.prototype[a]=function(e){return function(){return this.ctx[e].apply(this.ctx,arguments),this}}(a)}for(o=0,i=t.length;o<i;o++){var f=t[o];n.prototype[f]=function(e){return function(){return this.ctx[e].apply(this.ctx,arguments)}}(f)}for(o=0,s=r.length;o<s;o++){var l=r[o];n.prototype[l]=function(e){return function(t){return typeof t=="undefined"?this.ctx[e]:(this.ctx[e]=t,this)}}(l)}},n}),define("graphit/util",["require","./global"],function(e){var t=e("./global"),n=jQuery(document),r=jQuery(window),i={__MODULE__:"graphit/util",injectMixin:function(e,t){if("prototype"in t)for(key in t.prototype)e.prototype[key]=t.prototype[key];else for(key in t){var n=t[key];this.isFunction(n)?e.prototype[key]=n:e[key]=n}},setParameters:function(e,t,n){this.checkParameters(t,n);for(key in t)e[key]=t[key]},checkParameters:function(e,t){for(name in e)if(!(name in t))throw console.error("Invalid Field:",name),"InvalidField";for(name in t){if(!(name in e))throw console.error("Missing parameter: ",name),"MissingParameter";var n=e[name];if(this.isNullOrUndef(n)&&"required"in t[name]&&!("default"in t[name]))throw console.error("Missing Parameter:",name),"MissingParameter"}},isNullOrUndef:function(e){return e===undefined||e==null?!0:!1},getGlobal:function(){return window.graphit},isArray:function(e){return Object.prototype.toString.call(e)===Object.prototype.toString.call([])},isString:function(e){return typeof e=="string"},isBoolean:function(e){return typeof e=="boolean"},isNumber:function(e){return typeof e=="number"},ucFirst:function(e){if(e.length<1)return e;var t=e.slice(0,1).toUpperCase();return t+e.slice(1)},isFunction:function(e){return typeof e=="function"},genId:function(){return t.genid+=1,t.genid},getDocumentById:function(e){return document.getElementById(e)},getMin:function(e){this.isArray(e)||(e=[e]);var t=e[0];for(var n=1;n<e.length;n++)e[n]<t&&(t=e[n]);return t},getWindowSize:function(){return[r.width(),r.height()]},getDocumentSize:function(){return[n.width(),n.height()]},centerElement:function(e){e.css("position","absolute"),e.css("top",Math.max(0,(r.height()-e.outerHeight())/2+r.scrollTop())+"px"),e.css("left",Math.max(0,(r.width()-e.outerWidth())/2+r.scrollLeft())+"px")}};return i}),define("graphit/log",[],function(){return{__MODULE__:"graphit/log",log:function(e){console.error.apply(console,arguments)},error:function(e){var t=["[-]"];t=t.concat(arguments),console.error.apply(console,t)},action:function(e){e="%c >> "+e,console.log(e,"background: #444; color: #fff")},result:function(e){console.log("<<",e)},title:function(e){e="%c >>> "+e+" <<<",console.log(e,"background: #222; color: #bada55")}}}),define("graphit/exception/InvalidParameter",["require"],function(e){function t(e){this.name="InvalidParameter",this.message=e}return t.prototype=new Error,t.prototype.constructor=t,t}),define("graphit/mixin/parameter",["require","graphit/log","graphit/util","graphit/exception/InvalidParameter","graphit/exception/MissingParameter"],function(e){var t=e("graphit/log"),n=e("graphit/util"),r=e("graphit/exception/InvalidParameter"),i=e("graphit/exception/MissingParameter");return{setParameters:function(e,t){t!==undefined&&this.checkParameters(e,t);for(key in e)console.log("Key/Value",key,e[key]),this[key]=e[key]},checkParameters:function(e,n){for(name in e)if(!(name in n))throw t.error(this.__MODULE__+" / Invalid Field:",name),new r(name);for(name in n){var s=n[name],o=undefined;if(name in e)o=e[name];else if(s.required){if(!("defaultValue"in s))throw t.error(this.__MODULE__+" / Missing parameter",name),new i(name);o=s.defaultValue}}}}}),define("graphit/draw/Canvas",["require","../exception/InvalidDocumentId","../draw/Context","graphit/util","../mixin/parameter"],function(e){function o(e){this.__MODULE__="graphit/draw/Canvas",this.checkParameters(e,s),this.element=null,this.context=null,this._newContext(e.width,e.height,e.id)}var t=e("../exception/InvalidDocumentId"),n=e("../draw/Context"),r=e("graphit/util"),i=e("../mixin/parameter"),s={width:{required:!0,defaultValue:100},height:{required:!0,defaultValue:100},id:{required:!1}};return o.prototype._newContext=function(e,r,i){var s=undefined;if(i!==undefined){s=document.getElementById(i);if(!s)throw new t(i)}else s=document.createElement("canvas");s.width=e,s.height=r,this.element=s,this.context=new n(s)},o.prototype.copyData=function(e){this.context.copyData(e.context,0,0,this.width(),this.height())},o.prototype.getCtx=function(){return this.context.ctx},o.prototype.toString=function(){return'<canvas width="'+this._width+'" height="'+this._height+' x="'+this.x+'" y="'+this.y+'">'},o.prototype.getContext=function(){return this.context},o.prototype.getElement=function(){return this.element},o.prototype.width=function(e){return e!==undefined?(this.element.width=e,this):this.element.width},o.prototype.height=function(e){return e!==undefined?(this.element.height=e,this):this.element.height},r.injectMixin(o,i),o}),define("graphit/draw/DoubleBuffer",["require","../exception/MissingParameter","../exception/InvalidDocumentId","../draw/Canvas"],function(e){function i(e){this.__MODULE__="graphit/draw/DoubleBuffer",this.front=new r(e),this.back=null}var t=e("../exception/MissingParameter"),n=e("../exception/InvalidDocumentId"),r=e("../draw/Canvas");return i.prototype.clearBackBuffer=function(){this.back=new r({width:this.width(),height:this.height()})},i.prototype.flip=function(){this.front.copyData(this.back)},i.prototype.toString=function(){return'<canvas width="'+this._width+'" height="'+this._height+' x="'+this.x+'" y="'+this.y+'">'},i.prototype.width=function(e){return e!==undefined?(this.front.width(e),this.back.width(e),this):this.front.width()},i.prototype.height=function(e){return e!==undefined?(this.front.height(e),this.back.height(e),this):this.front.height()},i}),define("graphit/draw/tool",["require"],function(e){var t=window.graphit,n={__MODULE__:"graphit/draw/tool",randInt:function(e){return Math.floor(Math.random()*e+1)},randomColor:function(){return"rgb("+this.randInt(255)+","+this.randInt(255)+","+this.randInt(255)+")"},strokeAndFill:function(e){e.fillStyle&&e.fill(),e.strokeStyle&&e.stroke()},incRotation:function(e,t){return e+=t,e>=360&&(c=Math.round(e/360),e-=c*360),Math.round(e*10)/10},saveAndRestore:function(e,t){e.save(),t(e),e.restore()}};return n}),define("graphit/draw/shape",["require","../util","./tool"],function(e){var t=e("../util"),n=e("./tool"),r={__MODULE__:"graphit/draw/shape",line:function(e,t,r,i,s){e.beginPath(),e.moveTo(t,r),e.lineTo(i,s),n.strokeAndFill(e),e.closePath()},rectangle:function(e,t,r,i,s){e.beginPath(),e.rect(t,r,i,s),n.strokeAndFill(e),e.closePath()},circle:function(e,t,r,i){e.beginPath(),e.arc(t,r,i,0,2*Math.PI,!1),n.strokeAndFill(e),e.closePath()}};return r}),define("graphit/draw/widget/Clock",["require","graphit/exception/MissingParameter","../Context","../DoubleBuffer","../Canvas","../tool","../shape","../../util"],function(e){function a(e,n,i){this.__MODULE__="graphit/draw/widget/clock";if(e===undefined||n===undefined)throw new t("width|height");this.dbuffer=new r({id:i,width:e,height:n}),this._width=e,this._height=n,this.hourFormat=24,this.drawMillisecond=!1,this.redrawDelay=1e3,this.date=new Date;var s=Math.PI/180;this.pi=s,this.msPart=.36*s,this.sPart=6*s,this.mnPart=6*s,this.hPart=360/this.hourFormat*s,this.background=null,this.needRefresh=!0,this.init()}var t=e("graphit/exception/MissingParameter"),n=e("../Context"),r=e("../DoubleBuffer"),i=e("../Canvas"),s=e("../tool"),o=e("../shape"),u=e("../../util");return a.prototype.init=function(){var e=this._width/8;this.sizeMillisecond=e*.5,this.sizeSecond=e*4,this.sizeMinute=e*3,this.sizeHour=e*1.5},a.prototype.getElement=function(){return this.dbuffer.front.element},a.prototype.drawBackground=function(e){function u(e){var t=n._width/1e3*e;return t.toString()}if(!this.needRefresh)return this.dbuffer.back.copyData(this.background);this.background=new i({width:this._width,height:this._height}),e=this.background.getCtx();var t=this._width/2;e.translate(t,t);var n=this,r=null;s.saveAndRestore(e,function(e){e.fillStyle="#241B1C",r=n.sizeSecond,o.rectangle(e,-r,-r,r*2,r*2)}),s.saveAndRestore(e,function(e){e.fillStyle="#63353B",r=n.sizeMinute,o.rectangle(e,-r,-r,r*2,r*2)}),s.saveAndRestore(e,function(e){e.fillStyle="#26211C",r=n.sizeHour,o.rectangle(e,-r,-r,r*2,r*2)}),s.saveAndRestore(e,function(e){e.fillStyle="#684E38",r=n.sizeMillisecond,o.rectangle(e,-r,-r,r*2,r*2)});var a=-5,f=0,l=6;e.textBaseline="middle",e.textAlign="center";for(var c=0;c<60;c+=5)s.saveAndRestore(e,function(e){var t=(c+45)*l*n.pi,r=n.sizeMinute,i=Math.cos(t),s=Math.sin(t);e.fillStyle="#DDAA00",e.strokeStyle="black";var o="bold "+u(15).toString()+"pt Arial";e.font=o;var h=a+r*i,p=f+r*s;e.fillText(c,h,p),e.strokeText(c,h,p)});l=360/n.hourFormat;for(var c=0;c<this.hourFormat;c+=3)s.saveAndRestore(e,function(e){var t=(c+90)*l*n.pi,r=n.sizeHour,i=Math.cos(t),s=Math.sin(t);e.fillStyle="#DDAA00",e.strokeStyle="black",e.font="bold "+u(30)+"pt Arial";var o=a+r*i,h=f+r*s;e.fillText(c,o,h),e.strokeText(c,o,h)});this.dbuffer.back.copyData(this.background)},a.prototype.draw=function(){var e=this;this.needRefresh&&this.init(),this.dbuffer.clearBackBuffer();var t=this.dbuffer.back.getCtx(),n=this._width/2;t.translate(n,n),t.lineCap="round",this.drawBackground(t);var r=this._width/1e3,i=1;this.drawMillisecond&&s.saveAndRestore(t,function(t){var n=e.date.getMilliseconds()*e.msPart;t.strokeStyle="#00462A",t.lineWidth=.5*i,t.rotate(n),o.line(t,0,-e.sizeMillisecond,0,0),o.circle(t,0,-e.sizeMillisecond,r)}),s.saveAndRestore(t,function(t){t.strokeStyle="#71266E",t.lineWidth=1*i,angle=Math.round(e.date.getSeconds())*e.sPart,t.rotate(angle),o.line(t,0,-e.sizeSecond,0,0),o.circle(t,0,-e.sizeSecond,r*2)}),s.saveAndRestore(t,function(t){t.strokeStyle="#FF7600",t.lineWidth=2*i,angle=Math.round(e.date.getMinutes())*e.mnPart,t.rotate(angle),o.line(t,0,-e.sizeMinute,0,0),o.circle(t,0,-e.sizeMinute,r*3)}),s.saveAndRestore(t,function(t){angle=Math.round(e.date.getHours())*e.hPart,t.strokeStyle="#E11D38",t.lineWidth=4*i,t.rotate(angle),o.line(t,0,-e.sizeHour,0,0),o.circle(t,0,-e.sizeHour,r*4)});var u=this._width/64;this.fillStyle="#241B1C",this.strokeStyle="#241B1C",o.rectangle(t,-u,-u,u*2,u*2),this.dbuffer.flip(),this.needRefresh=!1},a.prototype.width=function(e){return e!==undefined&&this._width!=e?(this._width=e,this.dbuffer.width(e),this.needRefresh=!0,this):this._width},a.prototype.height=function(e){return e!==undefined&&this._height!=e?(this._height=e,this.dbuffer.height(e),this.needRefresh=!0,this):this._height},a}),define("graphit/test/clock",["require","../global","../draw/widget/Clock","../util","../log"],function(e){function s(e){this.__MODULE__="graphit/test/clock",e!==undefined&&r.setParameters(this,e,{width:{required:!0,defaultValue:200},height:{require:!0,defaultValue:200},max_size:{required:!1,defaultValue:200},numClock:{required:!0,"default":1}})}var t=e("../global"),n=e("../draw/widget/Clock"),r=e("../util"),i=e("../log");return s.prototype.run=function(){function u(){return r.getMin(r.getDocumentSize())}function p(){var e=new Date;for(var t=0;t<s.length;t++){var n=s[t];e.setHours(e.getHours()+t),n.date=e,n.draw()}setTimeout(p,o)}var e=320,t=1,s=[],o=100;i.action("Creating "+t+" clocks");var a=u(),f=a,l=u();for(var c=0;c<t;c++){s[c]=new n(a,f),s[c].drawMillisecond=!0;var h=jQuery('<div class="clock-container"></div>');h.width(l).height(l),h.append(s[c].getElement()),s[c].element=h,jQuery("body").append(h)}i.action("Register RESIZE event listener"),jQuery(".clock-container").draggable(),i.action("Running callback"),p()},new s}),define("graphit/main",["require","./test/clock"],function(e){var t=e("./test/clock");t.run()}),requirejs.config({baseUrl:"lib",paths:{graphit:"../graphit"}}),requirejs(["graphit/main"]),define("app",function(){});